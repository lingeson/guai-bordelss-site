<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>GUAI BORDEL'SS 2025 - R√©sultats & Phase finale</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin:0; padding:0;
    background:#f4f4f4;
    color:#333;
  }
  header {
    background:#2c3e50;
    color:#fff;
    text-align:center;
    padding:1rem;
  }
  img.logo {
    max-height:80px;
    vertical-align:middle;
  }
  nav {
    background:#34495e;
    display:flex;
    justify-content:center;
    flex-wrap:wrap;
    padding:0.5rem;
  }
  nav button {
    margin:5px;
    padding:10px 20px;
    font-size:16px;
    background:#ecf0f1;
    border:none;
    border-radius:5px;
    cursor:pointer;
    transition:background-color 0.3s;
  }
  nav button:hover, nav button.active {
    background:#bdc3c7;
  }
  .content {
    max-width:900px;
    margin:auto;
    padding:1rem;
  }
  .section {
    display:none;
  }
  .section.active {
    display:block;
  }
  .sports-buttons, .poule-buttons {
    display:flex;
    justify-content:center;
    flex-wrap:wrap;
    margin-bottom:1rem;
  }
  .sport-button, .poule-button {
    margin:5px 10px;
    padding:8px 15px;
    font-size:18px;
    cursor:pointer;
    background:#ecf0f1;
    border:none;
    border-radius:5px;
    transition:background-color 0.3s;
  }
  .sport-button:hover, .poule-button:hover,
  .sport-button.active, .poule-button.active {
    background:#bdc3c7;
  }
  table {
    width:100%;
    border-collapse:collapse;
    background:#fff;
    box-shadow:0 2px 4px rgba(0,0,0,0.1);
  }
  th, td {
    padding:8px;
    border:1px solid #ddd;
    text-align:center;
  }
  th {
    background:#34495e;
    color:#fff;
  }
  .message {
    text-align:center;
    font-style:italic;
    margin-top:1rem;
    color:#666;
  }
</style>
</head>
<body>

<header>
  <img src="logo.png" alt="Logo" class="logo" />
  <h1>GUAI BORDEL'SS 2025</h1>
</header>

<nav>
  <button id="btn-accueil" class="active" onclick="showSection('accueil')">Accueil</button>
  <button id="btn-resultats" onclick="showSection('resultats')">R√©sultats</button>
  <button id="btn-phase-finale" onclick="showSection('phase-finale')">Phase finale</button>
</nav>

<div class="content">

  <!-- Accueil -->
  <section id="accueil" class="section active">
    <h2>Bienvenue !</h2>
    <p>Retrouvez toutes les informations des GUAI BORDEL'SS 2025.</p>
  </section>

  <!-- R√©sultats -->
  <section id="resultats" class="section">
    <h2>R√©sultats des matchs</h2>
    <div class="sports-buttons" id="buttons-resultats"></div>
    <div class="poule-buttons" id="buttons-poules-resultats"></div>
    <div id="container-resultats" class="message">Veuillez choisir un sport et une poule.</div>
  </section>

  <!-- Phase finale -->
  <section id="phase-finale" class="section">
    <h2>Phase finale</h2>
    <div class="sports-buttons" id="buttons-phase-finale"></div>
    <div id="container-phase-finale" class="message">Veuillez choisir un sport.</div>
  </section>

</div>

<script>
  /* ----------- Configuration des sports et CSV ----------- */
  const sports = {
    handball: {
      nom: "Handball",
      emoji: "ü§æ‚Äç‚ôÇÔ∏è",
      // R√©sultats par poule (A et B)
      resultats: {
        A: "https://docs.google.com/spreadsheets/d/e/2PACX-1vQQpiogP-Kxoy3rgyFf1nEZd6GxJ_3mcB7pR6LuBPnEP1Y2ThgIOT6qThTDmgv4uV4O3zzl2ZgAZMlu/pub?output=csv",
        B: "https://docs.google.com/spreadsheets/d/e/2PACX-1vQpyqABCdEfgh/pub?output=csv" // Exemple poule B
      },
      phaseFinale: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRANDOMFINAL/pub?output=csv"
    },
    rugby: {
      nom: "Rugby",
      emoji: "üèâ",
      resultats: {
        A: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRXr9r0Rbn6xQ7tU7BaV2acg9goIg3B8aIQVbLKo9VaSo4cD2zRfcmWEy-ykMmn6cAfKbe7Bbi1Dz2F/pub?output=csv",
        B: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRUGBYB/pub?output=csv"
      },
      phaseFinale: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRANDOMFINALRUGBY/pub?output=csv"
    }
    // Ajoute d'autres sports si besoin, avec les URLs appropri√©es
  };

  /* ----------- Gestion de l'affichage des sections ----------- */
  function showSection(id) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');

    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    document.getElementById('btn-' + id).classList.add('active');
  }

  /* ----------- Fonction simple pour parser CSV en tableau ----------- */
  function parseCSV(csvText) {
    const lines = csvText.trim().split('\n');
    return lines.map(line => {
      // On divise par virgule, sans gestion complexe des guillemets (ajouter si besoin)
      return line.split(',').map(cell => cell.trim());
    });
  }

  /* ----------- R√©cup√©ration et parsing CSV via fetch ----------- */
  async function fetchCSV(url) {
    try {
      const res = await fetch(url);
      if (!res.ok) throw new Error(`Erreur HTTP ${res.status}`);
      const text = await res.text();
      return parseCSV(text);
    } catch (e) {
      console.error('Erreur fetchCSV:', e);
      throw e;
    }
  }

  /* ----------- Cr√©ation dynamique des boutons sports ----------- */
  function createSportButtons(containerId, onClick) {
    const container = document.getElementById(containerId);
    container.innerHTML = '';
    Object.entries(sports).forEach(([key, sport]) => {
      const btn = document.createElement('button');
      btn.className = 'sport-button';
      btn.innerText = `${sport.emoji} ${sport.nom}`;
      btn.title = sport.nom;
      btn.onclick = () => {
        // D√©sactive tous les boutons
        container.querySelectorAll('button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        onClick(key);
      };
      container.appendChild(btn);
    });
  }

  /* ----------- Gestion des boutons poules pour r√©sultats ----------- */
  function createPouleButtons(containerId, onClick) {
    const container = document.getElementById(containerId);
    container.innerHTML = '';
    ['A', 'B'].forEach(poule => {
      const btn = document.createElement('button');
      btn.className = 'poule-button';
      btn.innerText = 'Poule ' + poule;
      btn.onclick = () => {
        container.querySelectorAll('button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        onClick(poule);
      };
      container.appendChild(btn);
    });
  }

  /* ----------- Affichage des r√©sultats selon sport et poule ----------- */
  async function afficherResultats(sportKey, poule) {
    const container = document.getElementById('container-resultats');
    container.innerHTML = 'Chargement des r√©sultats...';

    const sport = sports[sportKey];
    if (!sport || !sport.resultats[poule]) {
      container.innerHTML = 'Pas de donn√©es pour ce sport ou cette poule.';
      return;
    }

    try {
      const rows = await fetchCSV(sport.resultats[poule]);
      if (rows.length < 2) {
        container.innerHTML = 'Aucun r√©sultat disponible.';
        return;
      }
      const headers = rows[0];
      const data = rows.slice(1);

      let html = '<table><thead><tr>';
      headers.forEach(h => html += `<th>${h}</th>`);
      html += '</tr></thead><tbody>';

      data.forEach(row => {
        html += '<tr>';
        row.forEach(cell => html += `<td>${cell}</td>`);
        html += '</tr>';
      });

      html += '</tbody></table>';
      container.innerHTML = html;
    } catch {
      container.innerHTML = 'Erreur lors du chargement des r√©sultats.';
    }
  }

  /* ----------- Affichage phase finale ----------- */
  async function afficherPhaseFinale(sportKey) {
    const container = document.getElementById('container-phase-finale');
    container.innerHTML = 'Chargement des matchs de la phase finale...';

    const sport = sports[sportKey];
    if (!sport || !sport.phaseFinale) {
      container.innerHTML = 'Pas de donn√©es de phase finale pour ce sport.';
      return;
    }

    try {
      const rows = await fetchCSV(sport.phaseFinale);
      if (rows.length < 2) {
        container.innerHTML = 'Aucun match de phase finale disponible.';
        return;
      }
      const headers = rows[0];
      const data = rows.slice(1);

      let html = '<table><thead><tr>';
      headers.forEach(h => html += `<th>${h}</th>`);
      html += '</tr></thead><tbody>';

      data.forEach(row => {
        html += '<tr>';
        row.forEach(cell => html += `<td>${cell}</td>`);
        html += '</tr>';
      });

      html += '</tbody></table>';
      container.innerHTML = html;
    } catch {
      container.innerHTML = 'Erreur lors du chargement de la phase finale.';
    }
  }

  /* ----------- Variables globales de s√©lection ----------- */
  let sportSelectionneResultats = null;
  let pouleSelectionnee = null;

  /* ----------- Initialisation R√©sultats ----------- */
  createSportButtons('buttons-resultats', sportKey => {
    sportSelectionneResultats = sportKey;
    // Reset poule s√©lectionn√©e
    pouleSelectionnee = null;
    document.getElementById('container-resultats').innerHTML = 'Veuillez choisir une poule.';
    createPouleButtons('buttons-poules-resultats', poule => {
      pouleSelectionnee = poule;
      afficherResultats(sportSelectionneResultats, pouleSelectionnee);
    });
  });

  /* ----------- Initialisation Phase Finale ----------- */
  createSportButtons('buttons-phase-finale', sportKey => {
    afficherPhaseFinale(sportKey);
  });

  // Par d√©faut afficher accueil
  showSection('accueil');
</script>

</body>
</html>
