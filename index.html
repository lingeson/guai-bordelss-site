<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>GUAI BORDEL'SS 2025 - R√©sultats & Phase finale</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin:0; padding:0;
    background:#f4f4f4;
    color:#333;
  }
  header {
    background:#2c3e50;
    color:#fff;
    text-align:center;
    padding:1rem;
  }
  img.logo {
    max-height:80px;
    vertical-align:middle;
  }
  nav {
    background:#34495e;
    display:flex;
    justify-content:center;
    flex-wrap:wrap;
    padding:0.5rem;
  }
  nav button {
    margin:5px;
    padding:10px 20px;
    font-size:16px;
    background:#ecf0f1;
    border:none;
    border-radius:5px;
    cursor:pointer;
    transition:background-color 0.3s;
  }
  nav button:hover, nav button.active {
    background:#bdc3c7;
  }
  .content {
    max-width:900px;
    margin:auto;
    padding:1rem;
  }
  .section {
    display:none;
  }
  .section.active {
    display:block;
  }
  .sports-buttons, .poule-buttons {
    display:flex;
    justify-content:center;
    flex-wrap:wrap;
    margin-bottom:1rem;
  }
  .sport-button, .poule-button {
    margin:5px 10px;
    padding:8px 15px;
    font-size:18px;
    cursor:pointer;
    background:#ecf0f1;
    border:none;
    border-radius:5px;
    transition:background-color 0.3s;
  }
  .sport-button:hover, .poule-button:hover,
  .sport-button.active, .poule-button.active {
    background:#bdc3c7;
  }
  table {
    width:100%;
    border-collapse:collapse;
    background:#fff;
    box-shadow:0 2px 4px rgba(0,0,0,0.1);
  }
  th, td {
    padding:8px;
    border:1px solid #ddd;
    text-align:center;
  }
  th {
    background:#34495e;
    color:#fff;
  }
  .message {
    text-align:center;
    font-style:italic;
    margin-top:1rem;
    color:#666;
  }
</style>
</head>
<body>

<header>
  <img src="logo.png" alt="Logo" class="logo" />
  <h1>GUAI BORDEL'SS 2025</h1>
</header>

<nav>
  <button id="btn-accueil" class="active" onclick="showSection('accueil')">Accueil</button>
  <button id="btn-resultats" onclick="showSection('resultats')">R√©sultats</button>
  <button id="btn-phase-finale" onclick="showSection('phase-finale')">Phase finale</button>
</nav>

<div class="content">

  <!-- Accueil -->
  <section id="accueil" class="section active">
    <h2>Bienvenue !</h2>
    <p>Retrouvez toutes les informations des GUAI BORDEL'SS 2025.</p>
  </section>

  <!-- R√©sultats -->
  <section id="resultats" class="section">
    <h2>R√©sultats des matchs</h2>
    <div class="sports-buttons" id="buttons-resultats"></div>
    <div class="poule-buttons" id="buttons-poules-resultats"></div>
    <div id="container-resultats" class="message">Veuillez choisir un sport et une poule.</div>
  </section>

  <!-- Phase finale -->
  <section id="phase-finale" class="section">
    <h2>Phase finale</h2>
    <div class="sports-buttons" id="buttons-phase-finale"></div>
    <div id="container-phase-finale" class="message">Veuillez choisir un sport.</div>
  </section>

</div>


  <script>
    const sports = {
      handball: {
        nom: "Handball",
        emoji: "ü§æ‚Äç‚ôÇÔ∏è",
        urlCSV: "https://docs.google.com/spreadsheets/d/e/2PACX-1vQQpiogP-Kxoy3rgyFf1nEZd6GxJ_3mcB7pR6LuBPnEP1Y2ThgIOT6qThTDmgv4uV4O3zzl2ZgAZMlu/pub?output=csv"
      },
      rugby: {
        nom: "Rugby",
        emoji: "üèâ",
        urlCSV: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=702928165&single=true&output=csv"
      }
    };

    const typesMatchs = ["Poule A", "Poule B", "Demi-finale", "Finale"];
    let sportSelectionne = null;
    let typeMatchSelectionne = null;
    let dataCSV = null;

    const nav = document.getElementById('nav-sports');
    const btnsTypeMatch = document.getElementById('buttons-type-match');
    const container = document.getElementById('container-resultats');
    const btnClassement = document.getElementById('btn-classement');
    const btnPhaseFinale = document.getElementById('btn-phase-finale');

    function createSportTabs() {
      Object.entries(sports).forEach(([key, sport]) => {
        const btn = document.createElement('button');
        btn.textContent = `${sport.emoji} ${sport.nom}`;
        btn.onclick = () => {
          sportSelectionne = key;
          dataCSV = null;
          typeMatchSelectionne = null;
          [...nav.children].forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          btnsTypeMatch.innerHTML = '';
          container.innerHTML = 'Chargement des donn√©es...';
          fetchCSVData(sports[key].urlCSV);
        };
        nav.appendChild(btn);
      });
    }

    function fetchCSVData(url) {
      fetch(url)
        .then(resp => resp.text())
        .then(csv => {
          const parsed = Papa.parse(csv.trim(), { skipEmptyLines: true });
          dataCSV = parsed.data;
          updateTypeButtons();
        })
        .catch(err => {
          container.innerHTML = "Erreur de chargement des donn√©es.";
          console.error(err);
        });
    }

    function updateTypeButtons() {
      const idxType = dataCSV[0].findIndex(h => h.toLowerCase().includes('type de match'));
      const types = [...new Set(dataCSV.slice(1).map(row => row[idxType]))].filter(Boolean);
      btnsTypeMatch.innerHTML = '';
      types.forEach(type => {
        const b = document.createElement('button');
        b.className = 'filter-button';
        b.textContent = type;
        b.onclick = () => {
          [...btnsTypeMatch.children].forEach(b => b.classList.remove('active'));
          b.classList.add('active');
          typeMatchSelectionne = type;
          showResults(type);
        };
        btnsTypeMatch.appendChild(b);
      });
      container.innerHTML = 'Veuillez choisir un type de match.';
      hideControls();
    }

    function showResults(type) {
      const headers = dataCSV[0];
      const idxType = headers.findIndex(h => h.toLowerCase().includes('type de match'));
      const filtered = dataCSV.slice(1).filter(row => row[idxType] === type);
      if (filtered.length === 0) {
        container.innerHTML = `<div class="message">Aucun match trouv√© pour ce type.</div>`;
        hideControls();
        return;
      }

      const table = document.createElement('table');
      const thead = document.createElement('thead');
      const tbody = document.createElement('tbody');

      thead.innerHTML = `<tr>${headers.map(h => `<th>${h}</th>`).join('')}</tr>`;
      filtered.forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = row.map(cell => `<td>${cell}</td>`).join('');
        tbody.appendChild(tr);
      });

      table.appendChild(thead);
      table.appendChild(tbody);
      container.innerHTML = '';
      container.appendChild(table);

      showControlsIfApplicable(type);
    }

    function hideControls() {
      btnClassement.style.display = 'none';
      btnPhaseFinale.style.display = 'none';
    }

    function showControlsIfApplicable(type) {
      if (type === 'Poule A' || type === 'Poule B') {
        btnClassement.style.display = 'inline-block';
      } else {
        btnClassement.style.display = 'none';
      }
      if (type === 'Demi-finale' || type === 'Finale') {
        btnPhaseFinale.style.display = 'inline-block';
      } else {
        btnPhaseFinale.style.display = 'none';
      }
    }

    // Initialisation
    createSportTabs();
  </script>
</body>
</html>
