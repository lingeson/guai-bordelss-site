<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GUAI BORDEL'SS 2025 - Résultats des Sports</title>

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- PapaParse CDN -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>

  <style>
    body {
      min-height: 100vh;
      background-color: #f3f4f6; /* bg-gray-100 */
    }
    nav a.active {
      @apply bg-blue-600 text-white;
    }
  </style>
</head>
<body class="flex flex-col min-h-screen">

  <header class="bg-white shadow-md">
    <div class="container mx-auto px-4 py-4 flex flex-wrap items-center justify-between">
      <h1 class="text-2xl font-bold text-blue-700">GUAI BORDEL'SS 2025 - Résultats</h1>
      <nav class="flex flex-wrap gap-2 mt-2 sm:mt-0">
        <!-- Navigation dynamique via JS -->
      </nav>
    </div>
  </header>

  <main class="container mx-auto px-4 py-8 flex-grow">
    <section>
      <h2 id="sport-title" class="text-xl font-semibold mb-4 text-center text-blue-800">Chargement...</h2>
      <div id="results" class="overflow-auto bg-white rounded shadow-md p-4 max-w-full"></div>
    </section>
  </main>

  <footer class="bg-white text-center p-4 text-gray-600 text-sm">
    &copy; 2025 GUAI BORDEL'SS - Tous droits réservés
  </footer>

  <script>
    // Liste des sports et leurs CSV publics Google Sheets
    const sports = [
      { name: "Handball", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=0&single=true&output=csv" },
      { name: "Rugby", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=702928165&single=true&output=csv" },
      { name: "Foot Masculin", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=35127129&single=true&output=csv" },
      { name: "Volley Masculin", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=1516588087&single=true&output=csv" },
      { name: "Basket Masculin", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=896073508&single=true&output=csv" },
      { name: "Basket Féminin", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=254686168&single=true&output=csv" },
      { name: "Foot Féminin", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=504548277&single=true&output=csv" },
      { name: "Volley Féminin", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=1381709457&single=true&output=csv" },
      { name: "Tennis", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=1395710737&single=true&output=csv" },
      { name: "Badminton", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=546083894&single=true&output=csv" },
      { name: "Ping-pong", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=906615525&single=true&output=csv" },
      { name: "Athlétisme", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=906615525&single=true&output=csv" },
      { name: "Natation", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=130176564&single=true&output=csv" },
      { name: "Escalade", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=361482653&single=true&output=csv" }
    ];

    // Elements DOM
    const nav = document.querySelector("nav");
    const title = document.getElementById("sport-title");
    const resultsDiv = document.getElementById("results");

    // Fonction pour créer la nav
    function createNav() {
      sports.forEach((sport, i) => {
        const a = document.createElement("a");
        a.href = "#";
        a.textContent = sport.name;
        a.className = "px-3 py-2 rounded hover:bg-blue-600 hover:text-white transition-colors duration-300";
        a.addEventListener("click", e => {
          e.preventDefault();
          setActiveSport(i);
        });
        nav.appendChild(a);
      });
    }

    // Gérer le sport actif
    let currentIndex = 0;
    function setActiveSport(index) {
      currentIndex = index;
      // Mise à jour nav active
      Array.from(nav.children).forEach((link, i) => {
        if(i === index) {
          link.classList.add("bg-blue-600", "text-white");
        } else {
          link.classList.remove("bg-blue-600", "text-white");
        }
      });
      // Mettre à jour le titre
      title.textContent = sports[index].name;
      // Charger le CSV
      loadCSV(sports[index].url);
    }

    // Fonction de chargement CSV et affichage
    function loadCSV(url) {
      resultsDiv.innerHTML = "<p class='text-center text-gray-500'>Chargement des données...</p>";

      Papa.parse(url, {
        download: true,
        header: true,
        skipEmptyLines: true,
        complete: function(results) {
          const data = results.data;
          if(data.length === 0) {
            resultsDiv.innerHTML = "<p class='text-red-600 text-center'>Aucune donnée disponible.</p>";
            return;
          }
          resultsDiv.innerHTML = "";
          resultsDiv.appendChild(createTable(data));
        },
        error: function(err) {
          resultsDiv.innerHTML = `<p class='text-red-600 text-center'>Erreur de chargement : ${err.message}</p>`;
        }
      });
    }

    // Fonction de création d'un tableau HTML à partir d'un array d'objets
    function createTable(data) {
      const table = document.createElement("table");
      table.className = "w-full border border-gray-300 rounded";

      // En-tête
      const thead = document.createElement("thead");
      const headerRow = document.createElement("tr");
      Object.keys(data[0]).forEach(key => {
        const th = document.createElement("th");
        th.textContent = key;
        th.className = "border border-gray-300 px-3 py-2 bg-gray-200 text-left text-sm font-semibold";
        headerRow.appendChild(th);
      });
      thead.appendChild(headerRow);
      table.appendChild(thead);

      // Corps
      const tbody = document.createElement("tbody");
      data.forEach(row => {
        const tr = document.createElement("tr");
        Object.values(row).forEach(val => {
          const td = document.createElement("td");
          td.textContent = val;
          td.className = "border border-gray-300 px-3 py-2 text-sm";
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);

      return table;
    }

    // Initialisation
    createNav();
    setActiveSport(0); // Charge le premier sport au départ
  </script>
</body>
</html>
