<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>GUAI BORDEL'SS 2025 - R√©sultats par poule</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background:#f4f4f4;
    color:#333;
    margin:0; padding:0;
  }
  header {
    background:#2c3e50;
    color:#fff;
    text-align:center;
    padding:1rem;
  }
  nav {
    background:#34495e;
    display:flex;
    justify-content:center;
    padding:0.5rem;
  }
  nav button {
    margin:0 10px;
    padding:10px 20px;
    font-size:16px;
    background:#ecf0f1;
    border:none;
    border-radius:5px;
    cursor:pointer;
    transition: background-color 0.3s;
  }
  nav button:hover, nav button.active {
    background:#bdc3c7;
  }
  .content {
    max-width:1200px;
    margin:auto;
    padding:1rem;
  }
  .sports-buttons {
    text-align:center;
    margin-bottom:1rem;
  }
  .sport-button {
    margin:5px 10px;
    padding:8px 15px;
    font-size:18px;
    cursor:pointer;
    background:#ecf0f1;
    border:none;
    border-radius:5px;
    transition:background-color 0.3s;
  }
  .sport-button:hover, .sport-button.active {
    background:#bdc3c7;
  }
  .poules-container {
    display:flex;
    justify-content: space-between;
    gap: 1rem;
  }
  .poule-box {
    background:#fff;
    padding:1rem;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    width:48%;
    display:flex;
    flex-direction: column;
  }
  h3 {
    text-align:center;
    margin-top:0;
  }
  table {
    width:100%;
    border-collapse: collapse;
    margin-bottom:1rem;
  }
  th, td {
    border: 1px solid #ddd;
    padding: 6px 10px;
    text-align:center;
  }
  th {
    background:#34495e;
    color:#fff;
  }
  .message {
    font-style: italic;
    text-align: center;
    color: #666;
  }
</style>
</head>
<body>

<header>
  <h1>GUAI BORDEL'SS 2025 - R√©sultats par poule</h1>
</header>

<nav>
  <button id="btn-accueil" class="active" onclick="showSection('accueil')">Accueil</button>
  <button id="btn-resultats" onclick="showSection('resultats')">R√©sultats</button>
  <button id="btn-phase-finale" onclick="showSection('phase-finale')">Phase finale</button>
</nav>

<div class="content">

  <!-- Accueil -->
  <section id="accueil" class="section active">
    <h2>Bienvenue !</h2>
    <p>Choisissez un sport pour voir les r√©sultats par poule.</p>
  </section>

  <!-- R√©sultats poules A et B -->
  <section id="resultats" class="section">
    <div class="sports-buttons" id="buttons-resultats"></div>

    <div class="poules-container">
      <div class="poule-box" id="pouleA-box">
        <h3>Poule A</h3>
        <div id="classement-pouleA" class="message">Chargement du classement...</div>
        <div id="resultats-pouleA" class="message">Chargement des r√©sultats...</div>
      </div>
      <div class="poule-box" id="pouleB-box">
        <h3>Poule B</h3>
        <div id="classement-pouleB" class="message">Chargement du classement...</div>
        <div id="resultats-pouleB" class="message">Chargement des r√©sultats...</div>
      </div>
    </div>
  </section>

  <!-- Phase finale -->
  <section id="phase-finale" class="section">
    <h2>Phase finale</h2>
    <div class="sports-buttons" id="buttons-phase-finale"></div>
    <div id="container-phase-finale" class="message">Veuillez choisir un sport.</div>
  </section>

</div>

<script>
  // Configuration des sports avec URL des CSV
  const sports = {
    handball: {
      nom: "Handball",
      emoji: "ü§æ‚Äç‚ôÇÔ∏è",
      classementA: "https://docs.google.com/spreadsheets/d/e/TON_CSV_CLASSEMENT_POULE_A/pub?output=csv",
      resultatsA: "https://docs.google.com/spreadsheets/d/e/TON_CSV_RESULTATS_POULE_A/pub?output=csv",
      classementB: "https://docs.google.com/spreadsheets/d/e/TON_CSV_CLASSEMENT_POULE_B/pub?output=csv",
      resultatsB: "https://docs.google.com/spreadsheets/d/e/TON_CSV_RESULTATS_POULE_B/pub?output=csv",
      phaseFinale: "https://docs.google.com/spreadsheets/d/e/TON_CSV_PHASE_FINALE/pub?output=csv"
    },
    rugby: {
      nom: "Rugby",
      emoji: "üèâ",
      classementA: "https://docs.google.com/spreadsheets/d/e/TON_CSV_CLASSEMENT_POULE_A_RUGBY/pub?output=csv",
      resultatsA: "https://docs.google.com/spreadsheets/d/e/TON_CSV_RESULTATS_POULE_A_RUGBY/pub?output=csv",
      classementB: "https://docs.google.com/spreadsheets/d/e/TON_CSV_CLASSEMENT_POULE_B_RUGBY/pub?output=csv",
      resultatsB: "https://docs.google.com/spreadsheets/d/e/TON_CSV_RESULTATS_POULE_B_RUGBY/pub?output=csv",
      phaseFinale: "https://docs.google.com/spreadsheets/d/e/TON_CSV_PHASE_FINALE_RUGBY/pub?output=csv"
    }
  };

  // Gestion affichage sections
  function showSection(id) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    document.getElementById('btn-' + id).classList.add('active');
  }

  // Parse CSV simple (pas de gestion avanc√©e des guillemets)
  function parseCSV(csvText) {
    const lines = csvText.trim().split('\n');
    return lines.map(line => line.split(',').map(cell => cell.trim()));
  }

  // Fetch CSV avec gestion erreur
  async function fetchCSV(url) {
    try {
      const res = await fetch(url);
      if(!res.ok) throw new Error(`Erreur HTTP ${res.status}`);
      const text = await res.text();
      return parseCSV(text);
    } catch(e) {
      console.error("fetchCSV erreur:", e);
      throw e;
    }
  }

  // Cr√©ation boutons sports
  function createSportButtons(containerId, onClick) {
    const container = document.getElementById(containerId);
    container.innerHTML = "";
    Object.entries(sports).forEach(([key, sport]) => {
      const btn = document.createElement("button");
      btn.className = "sport-button";
      btn.innerText = `${sport.emoji} ${sport.nom}`;
      btn.title = sport.nom;
      btn.onclick = () => {
        container.querySelectorAll('button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        onClick(key);
      };
      container.appendChild(btn);
    });
  }

  // Affiche tableau HTML depuis donn√©es CSV (array of arrays)
  function afficherTableau(containerId, data) {
    if(data.length === 0) {
      document.getElementById(containerId).innerHTML = '<p class="message">Aucune donn√©e disponible.</p>';
      return;
    }
    const headers = data[0];
    const rows = data.slice(1);
    let html = "<table><thead><tr>";
    headers.forEach(h => html += `<th>${h}</th>`);
    html += "</tr></thead><tbody>";
    rows.forEach(row => {
      html += "<tr>";
      row.forEach(cell => html += `<td>${cell}</td>`);
      html += "</tr>";
    });
    html += "</tbody></table>";
    document.getElementById(containerId).innerHTML = html;
  }

  // Affiche classement + r√©sultats pour une poule (A ou B)
  async function afficherPoule(sportKey, poule) {
    const sport = sports[sportKey];
    if(!sport) return;

    // IDs dynamiques selon poule
    const classementId = poule === "A" ? "classement-pouleA" : "classement-pouleB";
    const resultatsId = poule === "A" ? "resultats-pouleA" : "resultats-pouleB";

    // URLs selon poule
    const urlClassement = poule === "A" ? sport.classementA : sport.classementB;
    const urlResultats = poule === "A" ? sport.resultatsA : sport.resultatsB;

    // Affiche "chargement..."
    document.getElementById(classementId).innerHTML = "Chargement du classement...";
    document.getElementById(resultatsId).innerHTML = "Chargement des r√©sultats...";

    try {
      const classementData = await fetchCSV(urlClassement);
      afficherTableau(classementId, classementData);
    } catch {
      document.getElementById(classementId).innerHTML = '<p class="message">Erreur chargement classement.</p>';
    }

    try {
      const resultatsData = await fetchCSV(urlResultats);
      afficherTableau(resultatsId, resultatsData);
    } catch {
      document.getElementById(resultatsId).innerHTML = '<p class="message">Erreur chargement r√©sultats.</p>';
    }
  }

  // Affichage phase finale
  async function afficherPhaseFinale(sportKey) {
    const container = document.getElementById('container-phase-finale');
    container.innerHTML = 'Chargement de la phase finale...';

    const sport = sports[sportKey];
    if(!sport || !sport.phaseFinale) {
      container.innerHTML = 'Pas de donn√©es pour la phase finale.';
      return;
    }

    try {
      const data = await fetchCSV(sport.phaseFinale);
      if(data.length < 2) {
        container.innerHTML = 'Aucun match en phase finale.';
        return;
      }
      const headers = data[0];
      const rows = data.slice(1);
      let html = "<table><thead><tr>";
      headers.forEach(h => html += `<th>${h}</th>`);
      html += "</tr></thead><tbody>";
      rows.forEach(row => {
        html += "<tr>";
        row.forEach(cell => html += `<td>${cell}</td>`);
        html += "</tr>";
      });
      html += "</tbody></table>";
      container.innerHTML = html;
    } catch {
      container.innerHTML = 'Erreur chargement phase finale.';
    }
  }

  // Variables s√©lection
  let sportSelectionneResultats = null;

  // Init boutons sports r√©sultats
  createSportButtons("buttons-resultats", sportKey => {
    sportSelectionneResultats = sportKey;
    afficherPoule(sportKey, "A");
    afficherPoule(sportKey, "B");
  });

  // Init boutons sports phase finale
  createSportButtons("buttons-phase-finale", sportKey => {
    afficherPhaseFinale(sportKey);
  });

  // Affiche accueil par d√©faut
  showSection('accueil');
</script>

</body>
</html>
