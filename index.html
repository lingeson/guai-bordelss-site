
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GUAI BORDEL'SS 2025 - R√©sultats & Phase finale</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin:0; padding:0;
      background:#f4f4f4;
      color:#333;
    }
    header {
      background:#2c3e50;
      color:#fff;
      text-align:center;
      padding:1rem;
    }
    img.logo {
      max-height:80px;
      vertical-align:middle;
    }
    nav {
      background:#34495e;
      display:flex;
      justify-content:center;
      flex-wrap:wrap;
      padding:0.5rem;
    }
    nav button {
      margin:5px;
      padding:10px 20px;
      font-size:16px;
      background:#ecf0f1;
      border:none;
      border-radius:5px;
      cursor:pointer;
      transition:background-color 0.3s;
    }
    nav button:hover, nav button.active {
      background:#bdc3c7;
    }
    .content {
      max-width:1000px;
      margin:auto;
      padding:1rem;
    }
    .section {
      display:none;
    }
    .section.active {
      display:block;
    }
    .sports-buttons, .poule-buttons {
      display:flex;
      justify-content:center;
      flex-wrap:wrap;
      margin-bottom:1rem;
    }
    .sport-button, .poule-button {
      margin:5px 10px;
      padding:8px 15px;
      font-size:18px;
      cursor:pointer;
      background:#ecf0f1;
      border:none;
      border-radius:5px;
      transition:background-color 0.3s;
    }
    .sport-button:hover, .poule-button:hover,
    .sport-button.active, .poule-button.active {
      background:#bdc3c7;
    }
    table {
      width:100%;
      border-collapse:collapse;
      background:#fff;
      box-shadow:0 2px 4px rgba(0,0,0,0.1);
    }
    th, td {
      padding:8px;
      border:1px solid #ddd;
      text-align:center;
    }
    th {
      background:#34495e;
      color:#fff;
    }
    .message {
      text-align:center;
      font-style:italic;
      margin-top:1rem;
      color:#666;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>
<body>

<header>
  <img src="logo.png" alt="Logo" class="logo" />
  <h1>GUAI BORDEL'SS 2025</h1>
</header>

<nav>
  <button class="nav-btn active" onclick="showSection('accueil')">Accueil</button>
  <button class="nav-btn" onclick="showSection('resultats')">R√©sultats</button>
  <button class="nav-btn" onclick="showSection('phase-finale')">Phase finale</button>
</nav>

<div class="content">

  <!-- Accueil -->
  <section id="accueil" class="section active">
    <h2>Bienvenue !</h2>
    <p>Retrouvez toutes les informations des GUAI BORDEL'SS 2025.</p>
  </section>

  <!-- R√©sultats -->
  <section id="resultats" class="section">
    <h2>R√©sultats des matchs</h2>
    <div class="sports-buttons" id="buttons-resultats"></div>
    <div class="poule-buttons" id="buttons-poules-resultats"></div>
    <div id="container-resultats" class="message">Veuillez choisir un sport et une poule.</div>
  </section>

  <!-- Phase finale -->
  <section id="phase-finale" class="section">
    <h2>Phase finale</h2>
    <div class="sports-buttons" id="buttons-phase-finale"></div>
    <div id="container-phase-finale" class="message">Veuillez choisir un sport.</div>
  </section>

</div>

<script>
  const sports = {
    handball: {
      nom: "Handball",
      emoji: "ü§æ‚Äç‚ôÇÔ∏è",
      urlCSV: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=0&single=true&output=csv"
    },
    rugby: {
      nom: "Rugby",
      emoji: "üèâ",
      urlCSV: ": https://docs.google.com/spreadsheets/d/e/2PACX-1vRWrOq4N-KeChvdjO4JaEyMZVm-e3G1PNxbX-gEhC7xMDo1Y2dV6-Ax28BOJ31voFSPHhR_dNHrDzIT/pub?gid=702928165&single=true&output=csv"
    }
  };

  function showSection(id) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    event.target.classList.add('active');
  }

  function createSportButtons() {
    const btnsResultats = document.getElementById('buttons-resultats');
    const btnsPhaseFinale = document.getElementById('buttons-phase-finale');
    Object.entries(sports).forEach(([key, sport]) => {
      const btn1 = document.createElement('button');
      btn1.className = 'sport-button';
      btn1.textContent = `${sport.emoji} ${sport.nom}`;
      btn1.onclick = () => showPoules(key, sport.urlCSV);
      btnsResultats.appendChild(btn1);

      const btn2 = document.createElement('button');
      btn2.className = 'sport-button';
      btn2.textContent = `${sport.emoji} ${sport.nom}`;
      btn2.onclick = () => showPhaseFinale(key, sport.urlCSV);
      btnsPhaseFinale.appendChild(btn2);
    });
  }

  function showPoules(sportKey, csvURL) {
    const poules = ['Poule A', 'Poule B'];
    const btns = document.getElementById('buttons-poules-resultats');
    btns.innerHTML = '';
    poules.forEach(poule => {
      const btn = document.createElement('button');
      btn.className = 'poule-button';
      btn.textContent = poule;
      btn.onclick = () => fetchAndDisplayWithClassement(csvURL, poule, 'container-resultats');
      btns.appendChild(btn);
    });
    document.getElementById('container-resultats').innerHTML = "Veuillez choisir une poule.";
  }

  function fetchAndDisplayWithClassement(url, pouleName, containerId) {
    fetch(url)
      .then(resp => resp.text())
      .then(csv => {
        const parsed = Papa.parse(csv.trim(), { skipEmptyLines: true }).data;
        const headers = parsed[0];
        const rows = parsed.slice(1).filter(row => row[headers.indexOf('Type de match')] === pouleName);
        const matchs = rows.map(row => ({
          equipeA: row[headers.indexOf('√âquipe A')],
          equipeB: row[headers.indexOf('√âquipe B')],
          scoreA: parseInt(row[headers.indexOf('Score A')]),
          scoreB: parseInt(row[headers.indexOf('Score B')])
        }));

        // Calcul classement
        const teams = {};
        matchs.forEach(m => {
          [m.equipeA, m.equipeB].forEach(e => {
            if (!teams[e]) teams[e] = { pts: 0, joues: 0, diff: 0, marque: 0 };
          });
          teams[m.equipeA].joues++;
          teams[m.equipeB].joues++;
          teams[m.equipeA].marque += m.scoreA;
          teams[m.equipeB].marque += m.scoreB;
          teams[m.equipeA].diff += m.scoreA - m.scoreB;
          teams[m.equipeB].diff += m.scoreB - m.scoreA;

          if (m.scoreA > m.scoreB) teams[m.equipeA].pts += 3;
          else if (m.scoreA < m.scoreB) teams[m.equipeB].pts += 3;
          else { teams[m.equipeA].pts += 1; teams[m.equipeB].pts += 1; }
        });

        const classement = Object.entries(teams).map(([nom, stats]) => ({ nom, ...stats }));
        classement.sort((a, b) => b.pts - a.pts || b.diff - a.diff || b.marque - a.marque);

        // Affichage
        const container = document.getElementById(containerId);
        container.innerHTML = '';

        // Classement
        const tableClassement = document.createElement('table');
        tableClassement.innerHTML = `
          <thead>
            <tr><th>√âquipe</th><th>Pts</th><th>J</th><th>Diff</th><th>Marqu√©s</th></tr>
          </thead>
          <tbody>
            ${classement.map(e => `
              <tr>
                <td>${e.nom}</td><td>${e.pts}</td><td>${e.joues}</td><td>${e.diff}</td><td>${e.marque}</td>
              </tr>
            `).join('')}
          </tbody>
        `;
        container.appendChild(tableClassement);

        // R√©sultats
        const tableMatchs = document.createElement('table');
        tableMatchs.innerHTML = `
          <thead><tr>${headers.map(h => `<th>${h}</th>`).join('')}</tr></thead>
          <tbody>
            ${rows.map(r => `<tr>${r.map(c => `<td>${c}</td>`).join('')}</tr>`).join('')}
          </tbody>
        `;
        container.appendChild(tableMatchs);
      });
  }

  function showPhaseFinale(sportKey, csvURL) {
    fetch(csvURL)
      .then(resp => resp.text())
      .then(csv => {
        const parsed = Papa.parse(csv.trim(), { skipEmptyLines: true }).data;
        const headers = parsed[0];
        const rows = parsed.slice(1);
        const getByType = type => rows.filter(row => row[headers.indexOf('Type de match')] === type);
        const matchByType = type => getByType(type).map(row => ({
          equipeA: row[headers.indexOf('√âquipe A')],
          equipeB: row[headers.indexOf('√âquipe B')],
          scoreA: parseInt(row[headers.indexOf('Score A')]),
          scoreB: parseInt(row[headers.indexOf('Score B')])
        }));

        const pouleA = getByType("Poule A");
        const pouleB = getByType("Poule B");
        const getClassement = (rows) => {
          const teams = {};
          rows.forEach(r => {
            const A = r[headers.indexOf('√âquipe A')];
            const B = r[headers.indexOf('√âquipe B')];
            const SA = parseInt(r[headers.indexOf('Score A')]);
            const SB = parseInt(r[headers.indexOf('Score B')]);
            [A, B].forEach(e => {
              if (!teams[e]) teams[e] = { pts: 0, diff: 0, marque: 0, joues: 0 };
            });
            teams[A].joues++; teams[B].joues++;
            teams[A].diff += SA - SB;
            teams[B].diff += SB - SA;
            teams[A].marque += SA;
            teams[B].marque += SB;
            if (SA > SB) teams[A].pts += 3;
            else if (SA < SB) teams[B].pts += 3;
            else { teams[A].pts += 1; teams[B].pts += 1; }
          });
          return Object.entries(teams).map(([equipe, stats]) => ({ equipe, ...stats }))
            .sort((a, b) => b.pts - a.pts || b.diff - a.diff || b.marque - a.marque);
        };

        const classementA = getClassement(pouleA);
        const classementB = getClassement(pouleB);

        const DF1 = `${classementA[0].equipe} vs ${classementB[1].equipe}`;
        const DF2 = `${classementB[0].equipe} vs ${classementA[1].equipe}`;

        const finale = getByType("Finale")[0];
        const F = finale
          ? `${finale[headers.indexOf('√âquipe A')]} ${finale[headers.indexOf('Score A')]} - ${finale[headers.indexOf('Score B')]} ${finale[headers.indexOf('√âquipe B')]}`
          : "√Ä venir";

        const container = document.getElementById('container-phase-finale');
        container.innerHTML = `
          <div style="text-align:center; font-size:18px; margin:1rem;">
            <div><strong>Demi-finale 1 :</strong><br>${DF1}</div><br>
            <div><strong>Demi-finale 2 :</strong><br>${DF2}</div><br>
            <div style="margin-top:1rem;font-size:22px;">üèÜ <strong>Finale</strong> üèÜ<br>${F}</div>
          </div>
        `;
      });
  }

function calculerClassement(data, poule) {
  const equipes = {};

  data.forEach(match => {
    const [type, equipeA, equipeB, scoreA, scoreB, , , , , pouleMatch] = match;
    if (pouleMatch !== poule) return;

    if (!equipes[equipeA]) equipes[equipeA] = { nom: equipeA, points: 0, joues: 0, gagnes: 0, nuls: 0, perdus: 0, bp: 0, bc: 0 };
    if (!equipes[equipeB]) equipes[equipeB] = { nom: equipeB, points: 0, joues: 0, gagnes: 0, nuls: 0, perdus: 0, bp: 0, bc: 0 };

    const scoreNumA = parseInt(scoreA, 10);
    const scoreNumB = parseInt(scoreB, 10);

    equipes[equipeA].joues += 1;
    equipes[equipeB].joues += 1;
    equipes[equipeA].bp += scoreNumA;
    equipes[equipeA].bc += scoreNumB;
    equipes[equipeB].bp += scoreNumB;
    equipes[equipeB].bc += scoreNumA;

    if (scoreNumA > scoreNumB) {
      equipes[equipeA].gagnes += 1;
      equipes[equipeB].perdus += 1;
      equipes[equipeA].points += 3;
    } else if (scoreNumA < scoreNumB) {
      equipes[equipeB].gagnes += 1;
      equipes[equipeA].perdus += 1;
      equipes[equipeB].points += 3;
    } else {
      equipes[equipeA].nuls += 1;
      equipes[equipeB].nuls += 1;
      equipes[equipeA].points += 1;
      equipes[equipeB].points += 1;
    }
  });

  return Object.values(equipes).sort((a, b) => b.points - a.points || (b.bp - b.bc) - (a.bp - a.bc));
}

function afficherClassement(classement, containerId) {
  const container = document.getElementById(containerId);
  const table = document.createElement('table');
  const thead = document.createElement('thead');
  thead.innerHTML = `
    <tr>
      <th>√âquipe</th>
      <th>Pts</th>
      <th>J</th>
      <th>G</th>
      <th>N</th>
      <th>P</th>
      <th>BP</th>
      <th>BC</th>
      <th>Diff</th>
    </tr>
  `;
  const tbody = document.createElement('tbody');
  classement.forEach(equipe => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${equipe.nom}</td>
      <td>${equipe.points}</td>
      <td>${equipe.joues}</td>
      <td>${equipe.gagnes}</td>
      <td>${equipe.nuls}</td>
      <td>${equipe.perdus}</td>
      <td>${equipe.bp}</td>
      <td>${equipe.bc}</td>
      <td>${equipe.bp - equipe.bc}</td>
    `;
    tbody.appendChild(tr);
  });
  table.appendChild(thead);
  table.appendChild(tbody);
  container.appendChild(table);
}

<div id="phase-finale-container">
  <div class="match demi-finale">
    <div class="equipe">1er Poule A</div>
    <div class="score">vs</div>
    <div class="equipe">2e Poule B</div>
  </div>
  <div class="match demi-finale">
    <div class="equipe">1er Poule B</div>
    <div class="score">vs</div>
    <div class="equipe">2e Poule A</div>
  </div>
  <div class="match petite-finale">
    <div class="equipe">Perdant DF1</div>
    <div class="score">vs</div>
    <div class="equipe">Perdant DF2</div>
  </div>
  <div class="match finale">
    <div class="equipe">Gagnant DF1</div>
    <div class="score">vs</div>
    <div class="equipe">Gagnant DF2</div>
  </div>
</div>

#phase-finale-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-top: 2rem;
}

.match {
  display: flex;
  justify-content: space-between;
  width: 60%;
  margin: 1rem 0;
  padding: 1rem;
  background-color: #ecf0f1;
  border-radius: 10px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.match.demi-finale {
  border-left: 5px solid #3498db;
}

.match.petite-finale {
  border-left: 5px solid #e67e22;
}

.match.finale {
  border-left: 5px solid #2ecc71;
}

.equipe {
  width: 40%;
  text-align: center;
  font-weight: bold;
}

.score {
  width: 20%;
  text-align: center;
  font-size: 1.2rem;
}

function afficherPhaseFinale(equipesQualifiees) {
  const container = document.getElementById('container-phase-finale');
  container.innerHTML = '';

  const phaseFinaleContainer = document.createElement('div');
  phaseFinaleContainer.id = 'phase-finale-container';

  const matchTypes = ['demi-finale', 'demi-finale', 'petite-finale', 'finale'];
  const matchLabels = [
    [equipesQualifiees[0], equipesQualifiees[3]],
    [equipesQualifiees[1], equipesQualifiees[2]],
    ['Perdant DF1', 'Perdant DF2'],
    ['Gagnant DF1', 'Gagnant DF2']
  ];

  matchLabels.forEach((match, index) => {
    const matchDiv = document.createElement('div');
    matchDiv.className = `match ${matchTypes[index]}`;

    const equipe1 = document.createElement('div');
    equipe1.className = 'equipe';
    equipe1.textContent = match[0];

    const score = document.createElement('div');
    score.className = 'score';
    score.textContent = 'vs';

    const equipe2 = document.createElement('div');
    equipe2.className = 'equipe';
    equipe2.textContent = match[1];

    matchDiv.appendChild(equipe1);
    matchDiv.appendChild(score);
    matchDiv.appendChild(equipe2);

    phaseFinaleContainer.appendChild(matchDiv);
  });

  container.appendChild(phaseFinaleContainer);
}



  createSportButtons();
</script>


</body>
</html>
